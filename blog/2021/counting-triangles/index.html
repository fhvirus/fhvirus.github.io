<!DOCTYPE html>
<html lang="zh-TW"><head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<title> Counting Triangles - FHVirus&#39; éš¨ç­† </title>
	<meta name="HandheldFriendly" content="True">
	<meta name="MobileOptimized" content="320">
	<meta name="referrer" content="no-referrer">
	<meta name="description" content="SproutOJ 252" />

	<meta property="og:site_name" content="FHVirus&#39; éš¨ç­†" />
	<meta property="og:locale" content="en_US" />
	<meta property="og:type" content="article" />
	<meta property="og:url" content="https://fhvirus.github.io/blog/2021/counting-triangles/" />
	<meta property="og:title" content="Counting Triangles" />
	<meta property="og:image" content="https://fhvirus.github.io/" />
	<meta property="og:description" content="SproutOJ 252" />

	
	<meta name="google-site-verification" content=OmeoCl3L8243BxuGCzij-BbCwBW3_bcDuT4df39yOds />
	

	<link rel="canonical" href="https://fhvirus.github.io/blog/2021/counting-triangles/">

	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-+0n0xVW2eSR5OomGNYDnhzAbDsOXxcvSN1TPprVMTNDbiYZCxYbOOl7+AMvyTG2x" crossorigin="anonymous">
	<link href="https://fhvirus.github.io/css/custom.css" rel="stylesheet" type="text/css"/>
	<link href="https://fhvirus.github.io/css/syntax.css" rel="stylesheet" type="text/css"/>
	<link href="https://fhvirus.github.io/css/anchor.css" rel="stylesheet" type="text/css"/>

	
	<link rel="shortcut icon" href="https://fhvirus.github.io/images/favicon.png">
	

	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/katex.min.css" integrity="sha384-ZPe7yZ91iWxYumsBEOn7ieg8q/o+qh/hQpSaPow8T6BwALcXSCS6C6fSRPIAnTQs" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/katex.min.js" integrity="sha384-ljao5I1l+8KYFXG7LNEA7DyaFvuvSCmedUf6Y6JI7LJqiu8q5dEivP2nDdFH31V4" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/contrib/auto-render.min.js" integrity="sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR" crossorigin="anonymous"></script>
<script>
	document.addEventListener("DOMContentLoaded", function() {
		renderMathInElement(document.body, {
			delimiters: [
				{left: '$$', right: '$$', display: true},
				{left: '$', right: '$', display: false},
				{left: '\\(', right: '\\)', display: false},
				{left: '\\[', right: '\\]', display: true}
			],
			throwOnError : false
		});
	});
</script>

	<script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.10/dist/clipboard.min.js"></script>

	
	<link href="https://fhvirus.github.io/index.xml" rel="alternate" type="application/rss+xml" title="FHVirus&#39; éš¨ç­†" />
	
</head>
<body>
		
<div class="mt-xl header">
	<div class="container">
		<div class="row justify-content-center">
			<div class="col-auto">
				<a href="https://fhvirus.github.io/">
					<h1 class="site-name">FHVirus&#39; éš¨ç­†</h1>
				</a>
			</div>
		</div>

		<div class="row">
			<ul class="nav nav-primary justify-content-center">
				
				<li class="nav-item">
					<a class="nav-link" href="/">
						
						Home
					</a>
				</li>
				
				<li class="nav-item">
					<a class="nav-link" href="/about/">
						
						About
					</a>
				</li>
				
				<li class="nav-item">
					<a class="nav-link" href="https://github.com/FHVirus">
						
						GitHub
					</a>
				</li>
				
				<li class="nav-item">
					<a class="nav-link" href="https://www.instagram.com/fh.virus/">
						
						IG
					</a>
				</li>
				
				<li class="nav-item">
					<a class="nav-link" href="/index.xml">
						
						RSS
					</a>
				</li>
				
			</ul>
		</div>
	</div>
</div>


<div class="content">
	<div class="container">
		<div class="row justify-content-center">
			<div class="col-10 col-lg-8">
				<h1 class="mx-0 blog-post-title">Counting Triangles</h1>

				<div class="mb-md-4 meta">
					
					
					<span class="author" title="FHVirus">
						FHVirus
					</span>
					
					

					<span class="date middot" title='Thu Jun 17 2021 21:08:38 CST'>
						2021-06-17
					</span>

					<div class="d-none d-md-inline tags">
						<ul class="list-unstyled d-inline">
							
							<li class="d-inline middot">
								<a href="/tags/%E9%A1%8C%E8%A7%A3">é¡Œè§£</a>
							</li>
							
						</ul>
					</div>
				</div>

				<div class="markdown blog-post-content">
					<p>çµ‚æ–¼æå®šäº†æ–°çš„ Theme ï¼ˆå¤§æ¦‚å§ï¼‰ï¼Œè©²å›ä¾†å¯«é¡Œäº†ã€‚</p>
<!-- more -->
<h2 id="é¡Œç›®httpsneojsprouttwproblem252"><a href="https://neoj.sprout.tw/problem/252/">é¡Œç›®</a></h2>
<p>çµ¦ä½ ä¸€å€‹ $N$ å€‹é»ã€$M$ æ¢é‚Šçš„ç°¡å–®ç„¡å‘åœ–ï¼ˆä¹Ÿå°±æ˜¯æ²’æœ‰è‡ªç’°æˆ–é‡é‚Šçš„ç„¡å‘åœ–ï¼‰ï¼Œè«‹ç®—å‡ºé€™å¼µåœ–è£¡æœ‰å¹¾å€‹ã€Œä¸‰è§’å½¢ã€ï¼Ÿ <br>
ã€Œä¸‰è§’å½¢ã€å®šç¾©ç‚ºä¸€çµ„æ•¸å° $(x,y,z)$ ï¼Œä½¿å¾— $0 \le x&lt;y&lt;z&lt;N$ ä¸” $(x,y),(y,z),(z,x)$ å‡ç‚ºåœ–ä¸Šçš„é‚Šã€‚</p>
<p>é€™å¼µåœ–çš„é»è¢«ç·¨è™Ÿç‚º $0$ åˆ° $Nâˆ’1$ ã€‚<br>
$3 \le N \le 10 ^ 5, 0 \le M \le 10 ^ 5$</p>
<hr>
<h3 id="å‰æƒ…æè¦">å‰æƒ…æè¦</h3>
<ul>
<li>C++ STL çš„ <code>unordered</code> ç³»åˆ—å¾ˆæ…¢ï¼Œå¯¦æ¸¬ä¹Ÿæœƒåƒ <code>TLE</code> ï¼Œæ€è€ƒçš„æ™‚å€™è«‹æš«æ™‚å¿½ç•¥ä»–å€‘çš„å­˜åœ¨ã€‚<code>gp_hash_table</code> è£¸è£¸çš„ç”¨ä¹Ÿæœƒ <code>TLE</code>ã€‚ä¸è¦å»æƒ³ Hash ã€‚
<img src="zck-no-unordered.png" alt="ORZCK">
<p class="caption"> ZCK æ€éº¼èªªå°±æ€éº¼åšã€‚ </p>
</li>
<li>è«‹å¥½å¥½æ¬£è³è¤‡é›œåº¦è­‰æ˜ï¼ˆæ‹œè¨—ï¼‰ã€‚ä¹Ÿè¨±å¯ä»¥å­¸åˆ°ä¸€äº›<del>å”¬çˆ›çš„æŠ€å·§</del>ç¾éº—çš„ä½œæ³•ã€‚</li>
</ul>
<h4 id="hand-shaking-lemma">Hand Shaking Lemma</h4>
<p>$$ 2 \vert E \vert = \sum_{v \in V}{d(v)} $$</p>
<p>ç™½è©±ä¾†èªªï¼Œä¸€å¼µåœ– $G = (V, E)$ ä¸­ï¼Œæ‰€æœ‰é»çš„é»åº¦å’Œç­‰æ–¼é‚Šæ•¸çš„å…©å€ã€‚<br>
è­‰æ˜æ‡‰è©²å¾ˆç›´è§€ï¼Œå› ç‚ºä¸€æ¢é‚Šæœƒè²¢ç»å…©å€‹é»åº¦ã€‚</p>
<hr>
<h2 id="ä½œæ³•ä¸€">ä½œæ³•ä¸€</h2>
<p>å˜—è©¦æšèˆ‰æ¯ä¸€å€‹é» $i \in V$ï¼Œç®—åŒ…å« $i$ çš„ä¸‰è§’å½¢æœ‰å¹¾å€‹ï¼Œæœ€å¾Œç¸½æ•¸ $\div 3$ã€‚</p>
<p>æ‡‰è©²ä¸é›£ç™¼ç¾æœ‰å…©ç¨®ä½œæ³•ï¼š</p>
<ol>
<li>æšèˆ‰é„°é‚Š $(i, u)$ å’Œ $(i, v)$ï¼Œçœ‹çœ‹å°é‚Š $(u, v)$ æ˜¯å¦å­˜åœ¨ã€‚è¤‡é›œåº¦ $O(d(i) ^ 2 \cdot w)$ã€‚</li>
<li>æšèˆ‰å°é‚Š $(u, v)$ï¼Œçœ‹çœ‹é„°é‚Š $(i, u)$ å’Œ $(i, v)$ æ˜¯å¦å­˜åœ¨ã€‚è¤‡é›œåº¦ $O(M \cdot w)$ã€‚</li>
</ol>
<p>å…¶ä¸­ï¼Œ$O(w)$ ä»£è¡¨æŸ¥è©¢ä¸€å€‹é‚Š $(i, j)$ å­˜ä¸å­˜åœ¨çš„è¤‡é›œåº¦ï¼Œè€Œæœ¬é¡Œè¦æ±‚ $w \in O(1)$ã€‚<br>
å†ä»”ç´°è§€å¯Ÿä¸€ä¸‹ï¼Œä½œæ³•ä¸€å°é»åº¦å°‘çš„é»å¥½åƒæ¯”è¼ƒåˆ’ç®—ã€‚<br>
å¦‚æœå°é»åº¦ $\le K$ çš„é»ç”¨æ–¹æ³•ä¸€ï¼Œè€Œé»åº¦ $&gt; K$ å‰‡ç”¨æ–¹æ³•äºŒæœƒç™¼ç”Ÿä»€éº¼äº‹å‘¢ï¼Ÿ</p>
<h4 id="å˜—è©¦å”¬çˆ›è­‰æ˜è¤‡é›œåº¦">å˜—è©¦<del>å”¬çˆ›</del>è­‰æ˜è¤‡é›œåº¦</h4>
<p>æƒ³å‡ºäº†ä¸€å€‹æœ‰é»å”¬çˆ›çš„æ–¹æ³•å°±ç®—ç®—çœ‹ä»–çš„è¤‡é›œåº¦å§ã€‚</p>
<ol>
<li>é»åº¦ $\le K$ï¼ˆä»¥ä¸‹ç¨±è¼•é»ï¼‰ï¼š
$$O(\sum_{d(i) \le K}{d(i) ^ 2} \cdot w) = O(K \cdot \sum_{d(i) \le K}{d(i)} \cdot w)$$
æŠŠä¸€å€‹ $d(i)$ æ›æ‰å°±è±ç„¶é–‹æœ—äº†å‘¢ã€‚å†æ ¹æ“š Hand Shaking Lemmaï¼š
$$O(K \cdot \sum_{d(i) \le K}{d(i)} \cdot w) = O(K \cdot M \cdot w)$$
æ¸…æ¥šæ˜ç­ã€‚</li>
<li>é»åº¦ $&gt; K$ï¼ˆä»¥ä¸‹ç¨±é‡é»ï¼‰ï¼š<br>
é¦–å…ˆè¦æ³¨æ„åˆ°é‡é»çš„æ•¸é‡æœ‰é™ã€‚<br>
è¨­å…¶æ•¸é‡ç‚º $C$ï¼Œå‰‡ $C \cdot K &lt; 2M$ï¼Œå³ $C &lt; \frac{2M}{K}$ã€‚<br>
Hand Shaking Lemma çœŸå¥½ç”¨ã€‚<br>
åšä¸€å€‹é»çš„è¤‡é›œåº¦å°±æ˜¯ $O(M \cdot w)$ï¼Œä¸€å…±æ˜¯ $O(\frac{M ^ 2}{K} \cdot w)$ã€‚</li>
</ol>
<p>ç¸½è¤‡é›œåº¦æ˜¯ $O(w \cdot (MK + \frac{M ^ 2}{K}))$ã€‚æœ‰æ²’æœ‰å¾ˆç†Ÿæ‚‰ï¼Ÿ</p>
<p>æ²’éŒ¯ï¼å°±æ˜¯æ ¹è™Ÿåˆ†å¡Šã€‚å– $K = \sqrt{M}$ æ™‚æœ‰æœ€å¥½è¤‡é›œåº¦ $O(w \cdot M ^ {1.5})$ã€‚</p>
<h4 id="é‚£éº¼-ow-å‘¢log-åˆä¸æ˜¯å¸¸æ•¸">é‚£éº¼ $O(w)$ å‘¢ï¼Ÿ$\log$ åˆä¸æ˜¯å¸¸æ•¸ã€‚</h4>
<p>æ²’éŒ¯ï¼Œé€™é¡Œå¸¶ $\log$ æœƒ <code>TLE</code>ã€‚ï¼ˆæˆ‘å¯«çš„æ‡‰è©²é‚„ç®—æœ‰èªªæœåŠ›ï¼Ÿ)<br>
é‚£è¦æ€éº¼è®“æŸ¥è©¢ä¸€å€‹é‚Šè®Šæˆ $O(1)$ å‘¢ï¼Ÿ</p>
<ol>
<li>é€™æ¬¡å…ˆçœ‹é‡é»ã€‚<br>
åæ­£éƒ½è‡³å°‘ $O(M)$ äº†ï¼Œå°±ä¹¾è„†æ¯å€‹é»éƒ½é–‹ä¸€æ¬¡ <code>bitset</code> ç´€éŒ„é„°å±…å§ã€‚<br>
é€™æ¨£æŸ¥é„°é‚Šå°± $O(1)$ äº†ã€‚</li>
<li>é‚£éº¼è¼•é»å‘¢ï¼Ÿå¥½åƒæ²’æœ‰é€™éº¼å¥½ç®—ã€‚<br>
å¦‚æœèƒ½å¤ åƒé‡é»ä¸€æ¨£ï¼Œä¸€æ¬¡ç®—æ‰€æœ‰ç›¸é—œä¸€å€‹é»çš„è©¢å•å‘¢ï¼Ÿ
ä¸å¦‚è©¦è©¦çœ‹ã€Œç´€éŒ„åŒä¸€å€‹é»æ‰€æœ‰è©¢å•ä¸€èµ·ç®—ã€å§ï¼</li>
</ol>
<h4 id="é›¢ç·š">é›¢ç·šï¼</h4>
<p>å°æ–¼æ‰€æœ‰è¼•é»ï¼ŒæŠŠè©¢å•å­˜èµ·ä¾†ï¼Œæœ€å¾Œåœ¨å°æ‰€æœ‰è¼•é»ä¸€å€‹ä¸€å€‹åšã€‚</p>
<p>æ¯æ¬¡ä¸€æ¨£é–‹ä¸€å€‹ <code>bitset</code>ï¼Œç„¶å¾Œå°æ–¼ä¸€å€‹é» $i$ï¼Œ</p>
<ol>
<li>æ›´æ–°æ‰€æœ‰ $u\ s.t.\ (u, i) \in E$</li>
<li>æŸ¥è©¢æ‰€æœ‰è©¢å•ã€‚</li>
</ol>
<p>é€™æ¨£æŸ¥è©¢å°± $O(1)$ äº†ï¼
è‡³æ–¼ç”¨å¥½çš„è¤‡é›œåº¦æ¸…ç©º <code>bitset</code> æœ‰å…©ç¨®ä½œæ³•ï¼š</p>
<ol>
<li>ç”¨ <code>vector</code> ç´€éŒ„å‰›å‰›æ”¹äº†å“ªäº›é»ï¼ŒåªæŠŠé€™äº›é‡è¨­ã€‚</li>
<li>æ”¹æˆç”¨ <code>int</code> ç´€éŒ„ï¼Œåœ¨åŸæœ¬è¦æ‰“ <code>true</code> çš„åœ°æ–¹è¨­æˆç¾åœ¨è™•ç†çš„é»ç·¨è™Ÿã€‚<br>
é€™å€‹å°æŠ€å·§å¸¸ç”¨åœ¨ä¾‹å¦‚ Kosaraju æˆ–äºŒåˆ†åœ–åŒ¹é…ç­‰éœ€è¦å¤§é‡é‡è¨­ä¸€å€‹ <code>bitset</code> çš„æ™‚å€™ã€‚</li>
</ol>
<p>å¥½è€¶ï¼Œé‚£å°±åšå®Œäº†ï¼</p>
<h3 id="å¯¦ä½œ">å¯¦ä½œ</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="k">const</span> <span class="kt">int</span> <span class="n">N</span> <span class="o">=</span> <span class="mi">100001</span><span class="p">;</span>

<span class="kt">signed</span> <span class="nf">main</span><span class="p">(){</span>
	<span class="n">ios_base</span><span class="o">::</span><span class="n">sync_with_stdio</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span><span class="n">cin</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span><span class="n">cout</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
	<span class="kt">int</span> <span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="p">;</span> <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">n</span> <span class="o">&gt;&gt;</span> <span class="n">m</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="n">ceil</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">m</span><span class="p">));</span>

	<span class="n">vector</span><span class="o">&lt;</span><span class="n">pii</span><span class="o">&gt;</span> <span class="n">es</span><span class="p">;</span>
	<span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">deg</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
	<span class="n">vector</span><span class="o">&lt;</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;&gt;</span> <span class="n">adj</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">());</span>
	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">m</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">){</span>
		<span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">u</span> <span class="o">&gt;&gt;</span> <span class="n">v</span><span class="p">;</span>
		<span class="o">++</span><span class="n">deg</span><span class="p">[</span><span class="n">u</span><span class="p">],</span> <span class="o">++</span><span class="n">deg</span><span class="p">[</span><span class="n">v</span><span class="p">];</span>
		<span class="n">adj</span><span class="p">[</span><span class="n">u</span><span class="p">].</span><span class="n">pb</span><span class="p">(</span><span class="n">v</span><span class="p">),</span> <span class="n">adj</span><span class="p">[</span><span class="n">v</span><span class="p">].</span><span class="n">pb</span><span class="p">(</span><span class="n">u</span><span class="p">);</span>
		<span class="n">es</span><span class="p">.</span><span class="n">pb</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">);</span>
	<span class="p">}</span>

	<span class="kt">int</span> <span class="n">ans</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	
	<span class="c1">// Heavy vertex
</span><span class="c1"></span>	<span class="n">bitset</span><span class="o">&lt;</span><span class="n">N</span><span class="o">&gt;</span> <span class="n">nei</span><span class="p">;</span>
	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">){</span>
		<span class="k">if</span><span class="p">(</span><span class="n">deg</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">k</span><span class="p">)</span> <span class="k">continue</span><span class="p">;</span>
		<span class="n">nei</span><span class="p">.</span><span class="n">reset</span><span class="p">();</span>
		<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="nl">v</span><span class="p">:</span> <span class="n">adj</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="n">nei</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
		<span class="k">for</span><span class="p">(</span><span class="k">auto</span> <span class="p">[</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">]</span><span class="o">:</span> <span class="n">es</span><span class="p">)</span> <span class="n">ans</span> <span class="o">+=</span> <span class="p">(</span><span class="n">nei</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="n">and</span> <span class="n">nei</span><span class="p">[</span><span class="n">v</span><span class="p">]);</span>
	<span class="p">}</span>

	<span class="c1">// Light vertex
</span><span class="c1"></span>	<span class="n">vector</span><span class="o">&lt;</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;&gt;</span> <span class="n">qs</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">());</span>
	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">){</span>
		<span class="k">if</span><span class="p">(</span><span class="n">deg</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">k</span><span class="p">)</span> <span class="k">continue</span><span class="p">;</span>
		<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">deg</span><span class="p">[</span><span class="n">i</span><span class="p">];</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span>
			<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">l</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">l</span> <span class="o">&lt;</span> <span class="n">j</span><span class="p">;</span> <span class="o">++</span><span class="n">l</span><span class="p">)</span>
				<span class="n">qs</span><span class="p">[</span><span class="n">adj</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]].</span><span class="n">pb</span><span class="p">(</span><span class="n">adj</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">l</span><span class="p">]);</span>
	<span class="p">}</span>

	<span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">la</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">);</span>
	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">){</span>
		<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="nl">v</span><span class="p">:</span> <span class="n">adj</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="n">la</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>
		<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="nl">v</span><span class="p">:</span> <span class="n">qs</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="n">ans</span> <span class="o">+=</span> <span class="p">(</span><span class="n">la</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">==</span> <span class="n">i</span><span class="p">);</span>
	<span class="p">}</span>

	<span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">ans</span> <span class="o">/</span> <span class="mi">3</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39;\n&#39;</span><span class="p">;</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p><a href="https://neoj.sprout.tw/challenge/173033/">Submission: 3750ms Accepted</a><br>
è¶…ä¹¾æ·¨çš„å•¦ã€‚æ„Ÿè¬ <code>ZCK</code> æä¾›ä½œæ³• ğŸ›ã€‚</p>
<blockquote>
<p>ä¹Ÿå¯ä»¥å°è¼•é»çš„é„°æ¥ä¸²åˆ—æ’åºå¾Œé›™æŒ‡é‡çˆ¬äº¤é›†ï¼Œ<br>
é‡é»ç¶­æŒä¸€æ¨£ä½œæ³•ï¼Œè¤‡é›œåº¦ä¸€æ¨£ã€‚<br>
å¯¦åšåœ¨<a href="https://pastebin.com/AZm4EuX2">é€™è£¡</a>ã€‚é€™ä»½æ¯”è¼ƒé†œåˆæ…¢ï¼ˆ7840msï¼‰æ‰€ä»¥å°±ä¸è§£é‡‹äº†ã€‚</p>
</blockquote>
<hr>
<h2 id="ä½œæ³•äºŒ">ä½œæ³•äºŒ</h2>
<p>å…ˆé™„ä¸Š<a href="https://blog.csdn.net/yang20141109/article/details/50382495">åŸå‡ºè™•</a>ã€‚</p>
<p>ä¸è¦ºå¾—ä¸Šä¸€å€‹ä½œæ³•æ¯å€‹ä¸‰è§’å½¢è¦ç®—ä¸‰æ¬¡å¾ˆç´¯è´…å—ï¼Ÿ<br>
å¦‚æœæˆ‘å€‘æŠŠé‚Šå®šå‘ï¼Œè®“æ‰€æœ‰é‚Šéƒ½å¾åº¦æ•¸è¼ƒå°ï¼ˆå¦‚æœåº¦æ•¸ä¸€æ¨£å°±å–ç·¨è™Ÿè¼ƒå°ï¼‰æŒ‡å‘åº¦æ•¸å¤§çš„é»ï¼Œ<br>
é€™æ¨£å°±ä¸æœƒé‡è¤‡ç®—äº†ï¼</p>
<p>ä¹Ÿå°±æ˜¯ï¼Œæˆ‘é™¤äº†é„°æ¥ä¸²åˆ— <code>vector&lt;vector&lt;int&gt;&gt; adj</code> ä¹‹å¤–ï¼Œ<br>
æˆ‘å€‘é‚„è¦åšå‡ºå¦ä¸€å€‹æ±æ± <code>vector&lt;vector&lt;int&gt;&gt; val</code>ï¼ˆval stands for validï¼‰ï¼Œ<br>
ä»£è¡¨ä¸€å€‹é»çš„é„°å±…ä¸­åº¦æ•¸æ¯”ä»–å¤§çš„äººã€‚</p>
<p>æ¥è‘—ï¼Œæˆ‘å€‘æšèˆ‰ï¼ˆä¸é ˆä¾åºï¼‰æ¯ä¸€å€‹é» $i$ çš„æ¯ä¸€æ¢ val é‚Š $(i, u)$ï¼Œ<br>
çœ‹ <code>val[i]</code> å’Œ <code>val[u]</code> æœ‰å¹¾å€‹é‡è¤‡çš„å…ƒç´ ï¼Œå°±åšå®Œäº†ï¼</p>
<h4 id="è¤‡é›œåº¦å‘¢">è¤‡é›œåº¦å‘¢ï¼Ÿ</h4>
<p>çœ‹èµ·ä¾†å¥½åƒæœ‰é»çˆ›ï¼Ÿ<br>
è©¦è‘—çœ‹æ¯ä¸€å€‹é»çš„ <code>val[i]</code> å¤§å°ï¼Œ
å¯ä»¥è­‰æ˜ä»–å€‘çš„å¤§å°ç‚º $O(\sqrt{M})$ï¼
<img src="eric_xiaorz.png" alt="eric_xiaorz"></p>
<p class="caption"> æˆ‘å°±ä¸è§£é‡‹äº†ã€‚ </p>
<p>æœ€å¤šæœ‰ $O(M)$ æ¬¡çœ‹å…©å€‹ <code>val[i]</code> äº¤é›†ï¼Œ<br>
å¦‚æœå…ˆæŠŠæ‰€æœ‰ <code>val[i]</code> æ’åºçš„è©±ï¼Œ<br>
ç”¨é›™æŒ‡é‡çˆ¬éå»è¤‡é›œåº¦å°±æ˜¯ $O(M \cdot \sqrt M) = O(M ^ {1.5})$ï¼</p>
<h4 id="å¯¦ä½œ-1">å¯¦ä½œ</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="k">const</span> <span class="kt">int</span> <span class="n">N</span> <span class="o">=</span> <span class="mi">100001</span><span class="p">;</span>

<span class="c1">// çµ¦å…©å€‹ ordered set æ±‚äº¤é›†
</span><span class="c1"></span><span class="kt">int</span> <span class="nf">inter</span><span class="p">(</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="o">&amp;</span><span class="n">a</span><span class="p">,</span> <span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="o">&amp;</span><span class="n">b</span><span class="p">){</span>
	<span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">ans</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="k">while</span><span class="p">(</span><span class="n">i</span> <span class="o">&lt;</span> <span class="n">a</span><span class="p">.</span><span class="n">size</span><span class="p">()</span> <span class="n">and</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">b</span><span class="p">.</span><span class="n">size</span><span class="p">()){</span>
		<span class="k">if</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">b</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="o">++</span><span class="n">i</span><span class="p">,</span> <span class="o">++</span><span class="n">j</span><span class="p">,</span> <span class="o">++</span><span class="n">ans</span><span class="p">;</span>
		<span class="k">else</span> <span class="o">++</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">b</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">?</span> <span class="nl">i</span> <span class="p">:</span> <span class="n">j</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="n">ans</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">signed</span> <span class="nf">main</span><span class="p">(){</span>
	<span class="n">ios_base</span><span class="o">::</span><span class="n">sync_with_stdio</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span><span class="n">cin</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span><span class="n">cout</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
	<span class="kt">int</span> <span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="p">;</span> <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">n</span> <span class="o">&gt;&gt;</span> <span class="n">m</span><span class="p">;</span>

	<span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">deg</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
	<span class="n">vector</span><span class="o">&lt;</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;&gt;</span> <span class="n">adj</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">());</span>
	<span class="n">vector</span><span class="o">&lt;</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;&gt;</span> <span class="n">val</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">());</span>

	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">m</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">){</span>
		<span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">u</span> <span class="o">&gt;&gt;</span> <span class="n">v</span><span class="p">;</span>
		<span class="o">++</span><span class="n">deg</span><span class="p">[</span><span class="n">u</span><span class="p">],</span> <span class="o">++</span><span class="n">deg</span><span class="p">[</span><span class="n">v</span><span class="p">];</span>
		<span class="n">adj</span><span class="p">[</span><span class="n">u</span><span class="p">].</span><span class="n">pb</span><span class="p">(</span><span class="n">v</span><span class="p">),</span> <span class="n">adj</span><span class="p">[</span><span class="n">v</span><span class="p">].</span><span class="n">pb</span><span class="p">(</span><span class="n">u</span><span class="p">);</span>
	<span class="p">}</span>

	<span class="c1">// å»ºç«‹ val
</span><span class="c1"></span>	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">){</span>
		<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="nl">j</span><span class="p">:</span> <span class="n">adj</span><span class="p">[</span><span class="n">i</span><span class="p">]){</span>
			<span class="c1">// ä¹Ÿå¯ä»¥ç”¨ tie(deg[i], i) &lt; tie(deg[j], j)
</span><span class="c1"></span>			<span class="k">if</span><span class="p">(</span><span class="n">deg</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">deg</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="n">or</span> <span class="p">(</span><span class="n">deg</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">deg</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="n">and</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">j</span><span class="p">))</span>
				<span class="n">val</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">pb</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
		<span class="p">}</span>
		<span class="n">sort</span><span class="p">(</span><span class="n">AI</span><span class="p">(</span><span class="n">val</span><span class="p">[</span><span class="n">i</span><span class="p">]));</span>
	<span class="p">}</span>

	<span class="kt">int</span> <span class="n">ans</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">){</span>
		<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="nl">j</span><span class="p">:</span> <span class="n">val</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
			<span class="n">ans</span> <span class="o">+=</span> <span class="n">inter</span><span class="p">(</span><span class="n">val</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">val</span><span class="p">[</span><span class="n">j</span><span class="p">]);</span>
	<span class="p">}</span>
	<span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">ans</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39;\n&#39;</span><span class="p">;</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p><a href="https://neoj.sprout.tw/challenge/173149/">Submission: 2540ms Accepted</a><br>
é€™ä½œæ³•è »é€šéˆçš„ã€‚ä¸éä¹Ÿè¨±å¯ä»¥çµ¦ä¸€é»å•Ÿç¤ºï¼Ÿ</p>
<p>2022/02/08 Update: ç”¨åˆ°é¡ä¼¼æŠ€å·§çš„é…·é¡Œï¼š<a href="https://codeforces.com/contest/506/problem/d">CodeForces 506D</a></p>
<hr>
<h2 id="ä½œæ³•ä¸‰">ä½œæ³•ä¸‰</h2>
<p>åœ¨<a href="https://www.zhihu.com/question/36652212">é€™è£¡</a>æ‰¾åˆ°çš„ç®—æ³•ï¼Œç”¨åˆ°äº†å¥‡æ€ªçŸ©é™£ä¹˜æ³•ï¼Œä¸å¯¦ç”¨ä½†é…·é…·çš„ã€‚<br>
è«–æ–‡åœ¨<a href="https://www.tau.ac.il/~nogaa/PDFS/ayz97.pdf">é€™è£¡</a>ï¼Œå…¶ä¸­ AYZ çš„ Z å°±æ˜¯ ZwiCKã€‚ç„¡æ‰€ä¸åœ¨çš„ ZCK ï¼ˆèª¤ã€‚</p>
<hr>
<h2 id="å¾Œè¨˜">å¾Œè¨˜</h2>
<p>åŸæœ¬è½å®Œé€™é¡Œä»¥å¾Œä»¥ç‚ºè‡ªå·±æ‡‚äº†ï¼Œä½†å¯«é¡Œçš„æ™‚å€™æ‰ç™¼ç¾è‡ªå·±ä»€éº¼éƒ½ä¸æ‡‚ qwq<br>
ä»¥å¾Œçœ‹å®Œåšæ³•é‚„æ˜¯ç›¡é‡å»è£œé¡Œå§ï¼ˆé‚„æœ‰å¥½å¤šç­‰è£œï¼‰ã€‚</p>
<p>å–œæ­¡é€™ç¨®<del>å†—é•·</del>è©³ç´°çš„é¡Œè§£çš„è©±éº»ç…©ç•™è¨€è®“æˆ‘çŸ¥é“ï¼Œ<br>
ç¶­æŒæˆ‘å‰µä½œé•·æ–‡çš„å‹•åŠ› &gt;&lt;<br>
ä¸ç„¶ä¹…è€Œä¹…ä¹‹å°±æœƒè®Šæˆå¯«ä¸€å…©å¥è©±ç„¶å¾Œä¸Ÿç¨‹å¼è‡ªå·±çœ‹çš„é¡å‹äº†å§ qwqã€‚
å¦å¤–ï¼Œå°æ–¼æ–°çš„ä¸»é¡Œæœ‰ä»€éº¼å»ºè­°çš„è©±ä¸€æ¨£å¯ä»¥ç•™è¨€åœ¨ä¸‹é¢å–”ã€‚</p>


				</div>

				

			</div>
		</div>
	</div>
</div>

<script src="https://cdn.jsdelivr.net/npm/anchor-js/anchor.min.js"></script>
<script>
	anchors.options = {
		placement: 'left',
		visible: 'touch',
		icon: '#'
	};
	anchors.add('.content h1, .content h2, .content h3');
</script>

<section class="comments">
	<script src="https://utteranc.es/client.js" repo="fhvirus/fhvirus.github.io" issue-term="pathname" label="comment" theme="github-light" crossorigin="anonymous" async></script>
</section>

<footer></footer>


	</body>

</html>
